# Goodnight 宵禁

- 作者: Jonesn、羽学
- 出处: 无
- 每天指定时间禁止进服或禁止召唤怪物（满足在线人数自动解禁召唤怪物）

## 更新日志

```
v2.2.0
彻底修复Reload覆盖写入怪物ID问题
给弹幕更新方法补充了权限检查
加入了/gn 指令方法控制配置项

v2.1.1
清除无用代码，给断开玩家连接加入全检查

v2.1.0
修复玩家加入服务器拦截方法
加入在线人数判断禁止召唤怪物
将配置项加以描述，并把禁怪物表整理为全进度BOSS的NpcID
修复每次/Reload都会写入一次内置怪物ID问题

v2.0.0
加入了禁止召唤怪物逻辑
羽学适配了.net6.0并重构了大部分方法
```

## 指令

| 语法                             | 别名  |       权限       |                   说明                   |
| -------------------------------- | :---: | :--------------: | :--------------------------------------: |

| /reload | 无 |  tshock.cfg.reload |    重载配置文件    |
| /gn | /宵禁 |  goodnight.admin |    查看宵禁指令菜单    |
| /gn on | 无 |  goodnight.admin |    开启或关闭宵禁功能    |
| /gn kick | 无 |  goodnight.admin |    开启或关闭断连功能    |
| /gn time start & stop hh:mm:ss | 无 |  goodnight.admin |    设置宵禁开启结束时间    |
| /gn plr num | 无 |  goodnight.admin |    设置宵禁时间内解禁怪物的在线人数    |
| /gn hm update name | 无 |  goodnight.admin |    添加指定玩家到豁免名单    |
| /gn hm clear name | 无 |  goodnight.admin |    把指定玩家从豁免名单移除    |
| /gn list | 无 |  goodnight.admin |    列出禁止怪物表    |
| /gn add name & id| 无 |  goodnight.admin |    添加指定禁止召唤怪物    |
| /gn del name & id| 无 |  goodnight.admin |    删除指定禁止召唤怪物    |





## 配置

```json
{
  "是否关闭宵禁": true,
  "宵禁是否断连": false,
  "玩家进服拦截消息": "当前为宵禁时间，无法加入游戏。",
  "踢出玩家断连消息": "到点了，晚安",
  "断连豁免玩家": [
  "羽学"
  ],
  "禁怪少于人数(设1为关闭禁怪)": 2,
  "宵禁时间设置(禁怪/断连)": {
    "Start": "00:00:00",
    "Stop": "05:00:00"
  },
  "禁止怪物生成表(NpcID)": [
    4,
    13,
    14,
    15,
    35,
    36,
    37,
    50,
    113,
    114,
    125,
    126,
    127,
    128,
    129,
    130,
    131,
    134,
    135,
    136,
    222,
    245,
    246,
    247,
    248,
    249,
    262,
    266,
    370,
    396,
    397,
    398,
    400,
    439,
    440,
    422,
    493,
    507,
    517,
    636,
    657,
    668
  ]
}
```
## 反馈
- 共同维护的插件库：https://github.com/Controllerdestiny/TShockPlugin
- 国内社区trhub.cn 或 TShock官方群等